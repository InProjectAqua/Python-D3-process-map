/*!
 * TableExport.js v3.2.5 (http://www.clarketravis.com)
 * Copyright 2016 Travis Clarke
 * Licensed under the MIT license
 */
!function(t,e){function n(t){return String(t).replace(/[&<>'\/]/g,function(t){return l.fn.tableExport.entityMap[t]})}function o(t,e){e&&(t+=1462);var n=Date.parse(t);return(n-new Date(Date.UTC(1899,11,30)))/864e5}function a(t,e){for(var n={},a={s:{c:1e7,r:1e7},e:{c:0,r:0}},i=0;i!=t.length;++i)for(var r=0;r!=t[i].length;++r){a.s.r>i&&(a.s.r=i),a.s.c>r&&(a.s.c=r),a.e.r<i&&(a.e.r=i),a.e.c<r&&(a.e.c=r);var f={v:t[i][r]};if(null!=f.v){var l=XLSX.utils.encode_cell({c:r,r:i});"number"==typeof f.v?f.t="n":"boolean"==typeof f.v?f.t="b":f.v instanceof Date?(f.t="n",f.z=XLSX.SSF._table[14],f.v=o(f.v)):f.t="s",n[l]=f}}return a.s.c<1e7&&(n["!ref"]=XLSX.utils.encode_range(a)),n}function i(){return this instanceof i?(this.SheetNames=[],void(this.Sheets={})):new i}function r(t){for(var e=new ArrayBuffer(t.length),n=new Uint8Array(e),o=0;o!=t.length;++o)n[o]=255&t.charCodeAt(o);return e}function f(t,e,n,o){if(".xlsx"===o){var f=new i,s=a(t);f.SheetNames.push(n),f.Sheets[n]=s;var x={bookType:"xlsx",bookSST:!1,type:"binary"},p=XLSX.write(f,x);t=r(p)}saveAs(new Blob([t],{type:e+";"+l.fn.tableExport.charset}),n+o)}var l=t.jQuery;l.fn.tableExport=function(t,e){var o,a,i,r=this,s=e?t:l.extend({},l.fn.tableExport.defaults,t),x=l.fn.tableExport.rowDel,p=s.ignoreRows instanceof Array?s.ignoreRows:[s.ignoreRows],u=s.ignoreCols instanceof Array?s.ignoreCols:[s.ignoreCols],b=s.ignoreCSS instanceof Array?s.ignoreCSS.join(", "):s.ignoreCSS;return s.bootstrap?(o=l.fn.tableExport.bootstrap[0]+" ",a=l.fn.tableExport.bootstrap[1]+" ",i=l.fn.tableExport.bootstrap[2]+" "):(o=l.fn.tableExport.defaultButton+" ",a=i=""),r.each(function(){function t(t){var e=f.find("caption:not(.head)");e.length?e.append(t):f.prepend('<caption class="'+i+s.position+'">'+t+"</caption>")}function r(e,n,i){var r="<button data-fileblob='"+e+"' class='"+o+a+i+"'>"+n+"</button>";t(r)}var f=l(this);e&&f.find("caption:not(.head)").remove();var d=f.find("tbody").find("tr"),d=s.headings?d.add(f.find("thead>tr")):d,d=s.footers?d.add(f.find("tfoot>tr")):d,c=s.headings?f.find("thead>tr").length:0,E="id"===s.fileName?f.attr("id")?f.attr("id"):l.fn.tableExport.defaultFileName:s.fileName,m={xlsx:function(t,e){var o=d.map(function(t,e){if(!~p.indexOf(t-c)&&!l(e).is(b)){var n=l(e).find("th, td");return[n.map(function(t,e){return~u.indexOf(t)||l(e).is(b)?void 0:l(e).text()}).get()]}}).get(),a=n(JSON.stringify({data:o,fileName:e,mimeType:l.fn.tableExport.xlsx.mimeType,fileExtension:l.fn.tableExport.xlsx.fileExtension})),i=l.fn.tableExport.xlsx.buttonContent,f=l.fn.tableExport.xlsx.defaultClass;r(a,i,f)},xls:function(t,e){var o=l.fn.tableExport.xls.separator,a=d.map(function(t,e){if(!~p.indexOf(t-c)&&!l(e).is(b)){var n=l(e).find("th, td");return n.map(function(t,e){return~u.indexOf(t)||l(e).is(b)?void 0:l(e).text()}).get().join(o)}}).get().join(t),i=n(JSON.stringify({data:a,fileName:e,mimeType:l.fn.tableExport.xls.mimeType,fileExtension:l.fn.tableExport.xls.fileExtension})),f=l.fn.tableExport.xls.buttonContent,s=l.fn.tableExport.xls.defaultClass;r(i,f,s)},csv:function(t,e){var o=l.fn.tableExport.csv.separator,a=d.map(function(t,e){if(!~p.indexOf(t-c)&&!l(e).is(b)){var n=l(e).find("th, td");return n.map(function(t,e){return~u.indexOf(t)||l(e).is(b)?void 0:l(e).text()}).get().join(o)}}).get().join(t),i=n(JSON.stringify({data:a,fileName:e,mimeType:l.fn.tableExport.csv.mimeType,fileExtension:l.fn.tableExport.csv.fileExtension})),f=l.fn.tableExport.csv.buttonContent,s=l.fn.tableExport.csv.defaultClass;r(i,f,s)},txt:function(t,e){var o=l.fn.tableExport.txt.separator,a=d.map(function(t,e){if(!~p.indexOf(t-c)&&!l(e).is(b)){var n=l(e).find("th, td");return n.map(function(t,e){return~u.indexOf(t)||l(e).is(b)?void 0:l(e).text()}).get().join(o)}}).get().join(t),i=n(JSON.stringify({data:a,fileName:e,mimeType:l.fn.tableExport.txt.mimeType,fileExtension:l.fn.tableExport.txt.fileExtension})),f=l.fn.tableExport.txt.buttonContent,s=l.fn.tableExport.txt.defaultClass;r(i,f,s)}};s.formats.forEach(function(t){m[t](x,E)})}),l("button[data-fileblob]").off("click").on("click",function(){var t=l(this).data("fileblob"),e=t.data,n=t.fileName,o=t.mimeType,a=t.fileExtension;f(e,o,n,a)}),l.fn.tableExport.update=function(t){r.tableExport(l.extend({},s,t),!0)},l.fn.tableExport.reset=function(t){r.tableExport(s,!0)},l.fn.tableExport.remove=function(t){r.each(function(){l(this).find("caption:not(.head)").remove()})},r},l.fn.tableExport.defaults={headings:!0,footers:!0,formats:["xls","csv","txt"],fileName:"id",bootstrap:!0,position:"bottom",ignoreRows:null,ignoreCols:null,ignoreCSS:".tableexport-ignore"},l.fn.tableExport.charset="charset=utf-8",l.fn.tableExport.xlsx={defaultClass:"xlsx",buttonContent:"Export to xlsx",mimeType:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",fileExtension:".xlsx"},l.fn.tableExport.xls={defaultClass:"xls",buttonContent:"Export to xls",separator:"	",mimeType:"application/vnd.ms-excel",fileExtension:".xls"},l.fn.tableExport.csv={defaultClass:"csv",buttonContent:"Export to csv",separator:",",mimeType:"application/csv",fileExtension:".csv"},l.fn.tableExport.txt={defaultClass:"txt",buttonContent:"Export to txt",separator:"  ",mimeType:"text/plain",fileExtension:".txt"},l.fn.tableExport.defaultFileName="myDownload",l.fn.tableExport.defaultButton="button-default",l.fn.tableExport.bootstrap=["btn","btn-default","btn-toolbar"],l.fn.tableExport.rowDel="\r\n",l.fn.tableExport.entityMap={"&":"&#38;","<":"&#60;",">":"&#62;","'":"&#39;","/":"&#47"}}(window);